<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Game for Kids</title> 
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div style="display: flex; height: 100vh; margin: 0; padding: 0;">
        <!-- Main Section -->
        <div style="flex: 3; padding: 20px; text-align: center;">
            <h1>Image Game for Kids</h1>

            <!-- Automatic Upload Form -->
            <form id="upload-form" method="POST" enctype="multipart/form-data">
                <div id="drop-area">
                    <p>Drag & Drop an image here or click to upload.</p>
                    <input id="file-input" type="file" name="image" accept="image/*" required>
                </div>
            </form>

            <!-- Delete Button -->
            <form method="POST">
                <button name="delete" value="1">Delete Image</button>
            </form>

            <!-- Transform Button -->
            <form method="POST">
                <button name="transform" value="1">Transform Image</button>
            </form>

            <!-- Display Image (Processed or Uploaded) -->
            {% if processed_image_name %}
                <div>
                    <h3>Processed Image:</h3>
                    <img src="/images/{{ processed_image_name }}" alt="Processed Image" class="resized-image">
                </div>
                <button>
                    <a href="/images/{{ processed_image_name }}" download="processed_image.png" style="color: white; text-decoration: none; font-size: 16px;">Download Processed Image </a>
                </button>
                
            {% elif image_name and image_path %}
                <div>
                    <h3>Uploaded Image:</h3>
                    <img src="{{ image_path }}" alt="Uploaded Photo" class="resized-image">
                </div>
            {% endif %}
            {% if message %}
            <h2>{{ message }}</h2>
            {% endif %}
        </div>

        <!-- Stickers Section -->
        <div style="flex: 0.5; overflow-y: auto; padding: 5px; border-left: 0px solid #f8ecec;">
            <h3>Available Stickers</h3>
            {% for sticker in stickers %}
                <div style="margin-bottom: 20px; text-align: center;">
                    <img src="/{{ sticker_folder }}/{{ sticker }}" alt="{{ sticker }}" 
                         style="width: 80%; max-width: 120px; border: 1px solid #ccc; border-radius: 5px;">
                    <form method="POST" style="margin-top: 5px;">
                        <input type="hidden" name="sticker-name" value="{{ sticker }}";>
                        <button name="selected-sticker" value="1" style="margin-top: 5px;">Use Sticker</button>
                    </form>
                </div>
            {% endfor %}
        </div>
    </div>

    <script>
        const dropArea = document.getElementById('drop-area');
        const fileInput = document.getElementById('file-input');
        const uploadForm = document.getElementById('upload-form');
    
        dropArea.addEventListener('dragover', (event) => {
            event.preventDefault();
            dropArea.classList.add('dragover');
        });
    
        dropArea.addEventListener('dragleave', () => {
            dropArea.classList.remove('dragover');
        });
    
        dropArea.addEventListener('drop', (event) => {
            event.preventDefault();
            dropArea.classList.remove('dragover');
    
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                fileInput.files = files;
                uploadForm.submit(); // Automatically submit the form
            }
        });
    
        dropArea.addEventListener('click', () => {
            fileInput.click();
        });

        // Automatically submit the form when a file is selected
        fileInput.addEventListener('change', () => {
            if (fileInput.files.length > 0) {
                uploadForm.submit();
            }
        });
    </script>
</body>
</html>
